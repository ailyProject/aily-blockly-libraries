# Arduino RS485 Blockly库

本库为aily blockly项目提供Arduino RS485通信功能支持，基于官方ArduinoRS485库开发。

## 功能特性

- 支持RS485串行通信协议
- 兼容MKR 485 Shield和MAX3157芯片组
- 提供半双工和全双工通信模式
- 支持自定义引脚配置
- 包含数据发送、接收、流控制功能
- 支持中断信号发送
- 提供简化的收发接口

## 支持的开发板

- Arduino UNO/MEGA (AVR系列)
- Arduino MKR系列 (SAMD系列)
- ESP32系列开发板
- Arduino UNO R4 (Renesas系列)

## 主要功能块

### 基础功能
- **初始化RS485通信**: 设置波特率并启动RS485通信
- **关闭RS485通信**: 停止RS485通信
- **设置RS485引脚**: 自定义发送、发送使能、接收使能引脚

### 数据发送
- **开始RS485发送**: 启用发送模式
- **RS485发送数据**: 发送字节数据
- **RS485打印**: 发送文本数据
- **RS485打印并换行**: 发送文本数据并添加换行符
- **结束RS485发送**: 停止发送模式
- **等待RS485发送完成**: 等待发送缓冲区清空

### 数据接收
- **启用RS485接收**: 启用接收模式
- **禁用RS485接收**: 停止接收模式
- **RS485有数据可读**: 检查是否有数据可读
- **读取RS485数据**: 读取接收到的字节
- **查看RS485下一个字节**: 预览下一个字节但不移除

### 高级功能
- **发送RS485中断信号**: 发送指定持续时间的中断信号（毫秒/微秒）

### 简化功能
- **RS485简单发送**: 自动处理发送开始/结束的便捷发送功能
- **RS485接收到数据时**: 自动处理数据接收的事件监听
- **RS485接收的数据**: 获取最近接收到的完整数据

## 使用说明

### 基本发送示例
```
初始化RS485通信 波特率9600
RS485简单发送 "Hello World"
```

### 基本接收示例
```
初始化RS485通信 波特率9600
RS485接收到数据时
  串口打印 RS485接收的数据
```

### 完整通信示例
```
初始化RS485通信 波特率9600
启用RS485接收

永远重复
  如果 RS485有数据可读
    串口打印 RS485接收的数据
  
  延时 1000 毫秒
  RS485简单发送 "测试数据"
```

## 硬件连接

### MKR 485 Shield连接方式
- ISO GND → RS485设备的GND
- A → RS485设备的A/Y
- B → RS485设备的B/Z
- 根据需要设置终端电阻跳线

### 自定义连接
使用"设置RS485引脚"块可以自定义：
- 发送引脚 (TX)
- 发送使能引脚 (DE) 
- 接收使能引脚 (RE)

## 注意事项

1. RS485是半双工通信协议，同一时间只能发送或接收
2. 在发送数据前确保调用"开始RS485发送"
3. 发送完成后记得调用"结束RS485发送"以释放总线
4. 使用简化功能块可以自动处理发送控制
5. 长距离通信时需要合理设置终端电阻

## 依赖库

本库基于Arduino官方的ArduinoRS485库，使用时会自动包含：
```cpp
#include <ArduinoRS485.h>
```

## 版本信息

- 版本: 1.0.0
- 作者: aily Project
- 许可: 遵循Arduino库许可协议
